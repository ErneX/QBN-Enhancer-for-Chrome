<html>
  <head>
    <script>
      function onRequest(request, sender, sendResponse) {
        chrome.pageAction.show(sender.tab.id);

				switch (request.name)
				        {
				           case "getPreferences":
				              sendResponse(
				                    {
				                      qbnShowVideos : localStorage["qbnShowVideos"],
															qbnShowImages : localStorage["qbnShowImages"],
															qbnIgnoreList : localStorage["qbnIgnoreList"]
				                    });
			              break;
										default:
											sendResponse({});
										break;
				        }
      };
      chrome.extension.onRequest.addListener(onRequest);
    </script>
  </head>
</html>